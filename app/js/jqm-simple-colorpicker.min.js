/*! jqm-simple-colorpicker (C)Armin Junge 02-09-2017 */

$.widget("vertumnus.colorpicker",$.mobile.popup,{options:{redText:"Red",greenText:"Green",blueText:"Blue",defaultColor:"#000000"},_defaultColorChanged:!0,_create:function(){this.element.addClass("ui-colorpicker").addClass("ui-content").addClass("ui-corner-all").html(`\n         <a id='${this.element.attr("id")}-ok' href='#' data-rel='back' class='ui-btn ui-corner-all ui-shadow ui-icon-check ui-btn-icon-notext ui-btn-left'>V</a>\n         <a href='#' data-rel='back' class='ui-btn ui-corner-all ui-shadow ui-icon-delete ui-btn-icon-notext ui-btn-right'>X</a>\n         <form>\n             <div id='${this.element.attr("id")}-color' class='colorpicker-color'></div>\n             <label for='${this.element.attr("id")}-red'>${this.options.redText}</label>\n             <input id='${this.element.attr("id")}-red' type='range' min='0' max='255' value='0' data-highlight="true" class="ui-colorpicker-red">\n             <label for='${this.element.attr("id")}-green'>${this.options.greenText}</label>\n             <input id='${this.element.attr("id")}-green' type='range' min='0' max='255' value='0' data-highlight="true" class="ui-colorpicker-green">\n             <label for='${this.element.attr("id")}-blue'>${this.options.blueText}</label>\n             <input id='${this.element.attr("id")}-blue' type='range' min='0' max='255' value='0' data-highlight="true" class="ui-colorpicker-blue">\n         </form>\n      `),this.element.find("input").each(function(){$(this).slider(),$(this).attr("type","number").attr("data-type","range").addClass("ui-shadow-inset").addClass("ui-body-inherit").addClass("ui-corner-all")}),this._super(),this.element.children(`#${this.element.attr("id")}-ok`).click({widget:this},this._pressOk),this.element.find("input").change({widget:this},this._changeColor)},_setOption:function(e,t){switch(this._super(e,t),e){case"defaultColor":this._defaultColorChanged=!0;break;case"redText":this.element.find(`label[for=${this.element.attr("id")}-red]`).text(t);break;case"greenText":this.element.find(`label[for=${this.element.attr("id")}-green]`).text(t);break;case"blueText":this.element.find(`label[for=${this.element.attr("id")}-blue]`).text(t)}},_pressOk:function(e){e.data.widget._firePicked()},_firePicked:function(){this._trigger("picked",null,{color:this.color()})},_changeColor:function(e){e.data.widget._setMyColor()},_setMyColor:function(){this.element.find(`#${this.element.attr("id")}-color`).css("background-color",this.color())},_extractColorsFrom:function(e){let t;return(t=/#?([a-zA-Z0-9]{2})([a-zA-Z0-9]{2})([a-zA-Z0-9]{2})/.exec(e))?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:(t=/rgb\((\d+), (\d+), (\d+)\)/.exec(e))?[t[1],t[2],t[3]]:[0,0,0]},open:function(e){e&&(e.defaultColor&&this._setOption("defaultColor",e.defaultColor),e.picked&&this._setOption("picked",e.picked)),this._defaultColorChanged&&(this.color(this.options.defaultColor),this._defaultColorChanged=!1),this._super(e)},color:function(e){let t,i,l;if(void 0===e)return t="0"+Number(this.element.find(`#${this.element.attr("id")}-red`).val()).toString(16),i="0"+Number(this.element.find(`#${this.element.attr("id")}-green`).val()).toString(16),l="0"+Number(this.element.find(`#${this.element.attr("id")}-blue`).val()).toString(16),"#"+t.slice(-2)+i.slice(-2)+l.slice(-2);[t,i,l]=this._extractColorsFrom(e),this.element.find(`#${this.element.attr("id")}-red`).val(t).slider("refresh"),this.element.find(`#${this.element.attr("id")}-green`).val(i).slider("refresh"),this.element.find(`#${this.element.attr("id")}-blue`).val(l).slider("refresh"),this._setMyColor()}});